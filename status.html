<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>進捗状況 - PSA代行サービス</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Hiragino Sans', 'Hiragino Kaku Gothic ProN', 'Yu Gothic', Meiryo, sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
            min-height: 100vh;
            padding: 80px 20px 20px;
            color: #1e293b;
            letter-spacing: 0.02em;
        }

        /* ナビゲーションバー */
        .navbar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(16px);
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
            border-bottom: 1px solid rgba(203, 213, 225, 0.3);
            z-index: 1000;
        }

        .navbar-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 24px;
        }

        .navbar-brand {
            font-size: 1.5rem;
            font-weight: 700;
            color: #0f172a;
            text-decoration: none;
            letter-spacing: 0.05em;
        }

        .navbar-menu {
            display: flex;
            gap: 8px;
            list-style: none;
        }

        .navbar-link {
            padding: 10px 20px;
            color: #475569;
            text-decoration: none;
            font-weight: 600;
            font-size: 15px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .navbar-link:hover {
            background: linear-gradient(135deg, #1e40af, #1e3a8a);
            color: white;
            transform: translateY(-2px);
        }

        .navbar-link.active {
            background: linear-gradient(135deg, #1e40af, #1e3a8a);
            color: white;
        }

        .mobile-menu-button {
            display: none;
            background: none;
            border: none;
            font-size: 28px;
            color: #1e40af;
            cursor: pointer;
        }

        /* ホームボタン */
        .btn-home-fixed {
            position: fixed;
            top: 20px;
            left: 20px;
            background: linear-gradient(135deg, #3b82f6, #1e40af);
            color: white;
            padding: 12px 20px;
            border-radius: 50px;
            text-decoration: none;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: inline-flex;
            align-items: center;
            gap: 8px;
            z-index: 1001;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }

        .btn-home-fixed:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 8px 20px rgba(59, 130, 246, 0.4);
        }

        .btn-home-fixed svg {
            width: 20px;
            height: 20px;
        }

        @media (max-width: 768px) {
            body {
                padding-top: 70px;
                padding-left: 10px;
                padding-right: 10px;
            }

            .btn-home-fixed {
                top: 10px;
                left: 10px;
                padding: 10px 16px;
                font-size: 13px;
            }

            .btn-home-fixed svg {
                width: 18px;
                height: 18px;
            }

            .navbar-brand {
                font-size: 1.2rem;
            }

            .mobile-menu-button {
                display: block;
            }

            .navbar-menu {
                display: none;
                position: absolute;
                top: 100%;
                left: 0;
                right: 0;
                background: white;
                flex-direction: column;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
                padding: 8px;
            }

            .navbar-menu.show {
                display: flex;
            }
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            animation: slideUp 0.8s ease-out;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .header {
            text-align: center;
            margin-bottom: 50px;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 16px;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .progress-card {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(16px);
            border-radius: 24px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(226, 232, 240, 0.5);
            padding: 60px 40px;
            margin-bottom: 40px;
        }

        /* 進捗ステップバー */
        .progress-steps {
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
            margin-bottom: 60px;
        }

        .progress-line {
            position: absolute;
            top: 30px;
            left: 0;
            right: 0;
            height: 4px;
            background: rgba(5, 150, 105, 0.2);
            z-index: 0;
        }

        .progress-line-fill {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            background: linear-gradient(135deg, #059669 0%, #10b981 50%, #34d399 100%);
            transition: width 0.8s ease;
            width: 0%;
        }

        .step {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
            position: relative;
            z-index: 1;
            flex: 1;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .step:hover .step-circle {
            transform: scale(1.05);
        }

        .step-circle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: rgba(5, 150, 105, 0.15);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 20px;
            transition: all 0.4s ease;
            border: 4px solid transparent;
            color: #64748b;
        }

        .step.active .step-circle {
            background: linear-gradient(135deg, #059669 0%, #10b981 50%, #34d399 100%);
            color: white;
            box-shadow: 0 8px 20px rgba(5, 150, 105, 0.4);
            transform: scale(1.15);
        }

        .step.completed .step-circle {
            background: linear-gradient(135deg, #059669 0%, #10b981 50%, #34d399 100%);
            color: white;
            border-color: #059669;
        }

        .step-label {
            font-size: 13px;
            font-weight: 600;
            text-align: center;
            color: #64748b;
            white-space: nowrap;
        }

        .step.active .step-label {
            color: #059669;
            font-weight: 700;
            font-size: 14px;
        }

        .step.completed .step-label {
            color: #059669;
            font-weight: 700;
        }

        /* 現在のステップ情報 */
        .current-step-info {
            text-align: center;
            padding: 30px;
            background: linear-gradient(135deg, #f0fdf4, #dcfce7);
            border-radius: 16px;
            border-left: 5px solid #059669;
            margin-bottom: 30px;
        }

        .current-step-info h2 {
            color: #059669;
            font-size: 1.5rem;
            margin-bottom: 12px;
        }

        .current-step-info p {
            color: #064e3b;
            font-size: 1rem;
            line-height: 1.8;
            margin-bottom: 12px;
        }

        .next-action {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border-left: 5px solid #f59e0b;
            padding: 20px;
            border-radius: 12px;
            margin-top: 16px;
        }

        .next-action strong {
            color: #92400e;
            font-size: 1rem;
            display: block;
            margin-bottom: 8px;
        }

        .next-action p {
            color: #78350f;
            font-size: 0.95rem;
            margin: 0;
        }

        /* モーダル */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            max-width: 600px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
            animation: modalSlide 0.3s ease-out;
        }

        @keyframes modalSlide {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            background: linear-gradient(135deg, #059669, #10b981);
            color: white;
            padding: 30px;
            border-radius: 20px 20px 0 0;
        }

        .modal-header h3 {
            font-size: 1.5rem;
            margin-bottom: 8px;
        }

        .modal-header p {
            opacity: 0.95;
            font-size: 0.95rem;
        }

        .modal-body {
            padding: 30px;
        }

        .modal-section {
            margin-bottom: 24px;
        }

        .modal-section h4 {
            color: #059669;
            font-size: 1.1rem;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 2px solid #d1fae5;
        }

        .modal-section p {
            color: #374151;
            line-height: 1.6;
            margin-bottom: 8px;
        }

        .modal-info-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #e5e7eb;
        }

        .modal-info-label {
            font-weight: 600;
            color: #374151;
        }

        .modal-info-value {
            color: #6b7280;
        }

        .modal-close {
            background: #e5e7eb;
            color: #374151;
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            margin-top: 20px;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            background: #d1d5db;
        }

        .back-link {
            display: inline-block;
            margin-top: 30px;
            padding: 14px 32px;
            background: linear-gradient(135deg, #1e40af, #2563eb);
            color: white;
            text-decoration: none;
            border-radius: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 8px 24px rgba(30, 64, 175, 0.35);
        }

        .back-link:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 32px rgba(30, 64, 175, 0.45);
        }

        @media (max-width: 768px) {
            .progress-card {
                padding: 40px 20px;
            }

            .step-circle {
                width: 40px;
                height: 40px;
                font-size: 14px;
            }

            .step.active .step-circle {
                transform: scale(1.1);
            }

            .step-label {
                font-size: 10px;
            }

            .step.active .step-label {
                font-size: 11px;
            }

            .progress-line {
                top: 20px;
            }

            .current-step-info h2 {
                font-size: 1.2rem;
            }

            .modal-content {
                max-height: 90vh;
            }
        }
    </style>
</head>
<body>
    <!-- ホームボタン -->
    <a href="/" class="btn-home-fixed">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25" />
        </svg>
        ホーム
    </a>

    <!-- ナビゲーションバー -->
    <nav class="navbar">
        <div class="navbar-container">
            <a href="/" class="navbar-brand">PSA代行サービス</a>
            <button class="mobile-menu-button" id="mobileMenuButton">☰</button>
            <ul class="navbar-menu" id="navbarMenu">
                <li><a href="/" class="navbar-link">代行フォーム</a></li>
                <li><a href="/status" class="navbar-link active">進捗確認</a></li>
                <li><a href="/approval" class="navbar-link">買取承認</a></li>
                <li><a href="/contact" class="navbar-link">お問い合わせ</a></li>
                <li><a href="/admin" class="navbar-link">管理者</a></li>
            </ul>
        </div>
    </nav>

    <div class="container">
        <div class="header">
            <h1>進捗状況</h1>
            <p>PSA代行買取承認システム</p>
        </div>

        <div class="progress-card">
            <!-- 進捗ステップバー -->
            <div class="progress-steps">
                <div class="progress-line">
                    <div class="progress-line-fill" id="progressFill"></div>
                </div>
                <div class="step" id="step1" onclick="showStepDetails(1)">
                    <div class="step-circle">1</div>
                    <div class="step-label">お申し込み<br>受付</div>
                </div>
                <div class="step" id="step2" onclick="showStepDetails(2)">
                    <div class="step-circle">2</div>
                    <div class="step-label">カード受領<br>・検品</div>
                </div>
                <div class="step" id="step3" onclick="showStepDetails(3)">
                    <div class="step-circle">3</div>
                    <div class="step-label">代行料<br>お支払い</div>
                </div>
                <div class="step" id="step4" onclick="showStepDetails(4)">
                    <div class="step-circle">4</div>
                    <div class="step-label">PSA<br>鑑定中</div>
                </div>
                <div class="step" id="step5" onclick="showStepDetails(5)">
                    <div class="step-circle">5</div>
                    <div class="step-label">鑑定料<br>お支払い</div>
                </div>
                <div class="step" id="step6" onclick="showStepDetails(6)">
                    <div class="step-circle">6</div>
                    <div class="step-label">返送<br>・完了</div>
                </div>
            </div>

            <!-- 現在のステップ情報 -->
            <div class="current-step-info" id="currentStepInfo">
                <h2>現在のステータス：お申し込み受付</h2>
                <p>お申し込みを受け付けました。カードのお預かりをお待ちしております。</p>

                <div class="next-action">
                    <strong>次にすべきこと：</strong>
                    <p>指定の住所にカードを発送してください。到着後、無料検品を行います。</p>
                </div>
            </div>

            <div style="text-align: center;">
                <a href="/" class="back-link">← トップページに戻る</a>
            </div>
        </div>
    </div>

    <!-- 詳細モーダル -->
    <div class="modal" id="detailModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">ステップ詳細</h3>
                <p id="modalSubtitle">詳細情報</p>
            </div>
            <div class="modal-body" id="modalBody">
                <!-- JavaScriptで動的に生成 -->
            </div>
        </div>
    </div>

    <script>
        // ステップ定義
        const stepData = {
            1: {
                title: 'お申し込み受付',
                subtitle: '代行フォーム入力完了',
                description: 'お申し込みを受け付けました。カードのお預かりをお待ちしております。',
                nextAction: '指定の住所にカードを発送してください。到着後、無料検品を行います。',
                details: {
                    '申込日': '2025-10-09',
                    '受付番号': 'PSA-2025-001',
                    'プラン': 'レギュラー',
                    'カード枚数': '15枚'
                },
                shippingAddress: '〒123-4567<br>東京都〇〇区〇〇 1-2-3<br>PSA代行サービス カード受付係'
            },
            2: {
                title: 'カード受領・検品',
                subtitle: '発送〜到着〜無料検品完了',
                description: 'カードの到着をお待ちしております。到着後、PSA10見込み判定を含む無料検品を実施します。',
                nextAction: 'カードを弊社指定住所へ発送してください。到着後24時間以内に検品結果をご連絡いたします。',
                details: {
                    '発送状況': '発送待ち',
                    '追跡番号': '未設定',
                    '到着予定': '発送後1-3日',
                    '検品状況': '未着'
                }
            },
            3: {
                title: '代行料お支払い',
                subtitle: '検品結果確認〜1回目決済',
                description: '検品結果をご確認の上、代行料をお支払いください。',
                nextAction: '検品結果をメールでお送りします。内容をご確認後、代行料をお支払いください。',
                details: {
                    '代行料': '未確定',
                    '支払方法': '銀行振込 / クレジットカード',
                    '支払期限': '検品完了後7日以内',
                    '支払状況': '未払い'
                }
            },
            4: {
                title: 'PSA鑑定中',
                subtitle: '提出〜鑑定期間〜結果確定',
                description: 'PSA社への提出準備を進めております。',
                nextAction: '鑑定完了までお待ちください。進捗は随時更新いたします。',
                details: {
                    'PSA提出日': '未提出',
                    'PSA追跡番号': '未発行',
                    '鑑定予定完了日': '提出後45-60日',
                    '選択プラン': 'レギュラー'
                }
            },
            5: {
                title: '鑑定料お支払い',
                subtitle: '結果通知〜2回目決済',
                description: '鑑定結果をご確認の上、鑑定料と返送料をお支払いください。',
                nextAction: '鑑定結果通知後、鑑定料と返送料をお支払いください。',
                details: {
                    '鑑定結果': '未確定',
                    '鑑定料': '未確定',
                    '返送料': '未確定',
                    '支払状況': '未払い'
                }
            },
            6: {
                title: '返送・完了',
                subtitle: '発送〜お客様受取完了',
                description: 'カードの返送準備を進めております。',
                nextAction: 'カードの発送後、追跡番号をお知らせします。',
                details: {
                    '返送方法': '未定',
                    '発送日': '未発送',
                    '追跡番号': '未発行',
                    '到着予定': '発送後1-3日'
                }
            }
        };

        // 現在のステップ（URLパラメータまたはデフォルト）
        const urlParams = new URLSearchParams(window.location.search);
        let currentStep = parseInt(urlParams.get('step')) || 1;
        if (currentStep < 1 || currentStep > 6) currentStep = 1;

        // 初期化
        document.addEventListener('DOMContentLoaded', () => {
            setupMobileMenu();
            updateProgress(currentStep);
        });

        // モバイルメニュー
        function setupMobileMenu() {
            const mobileMenuButton = document.getElementById('mobileMenuButton');
            const navbarMenu = document.getElementById('navbarMenu');

            if (mobileMenuButton) {
                mobileMenuButton.addEventListener('click', () => {
                    navbarMenu.classList.toggle('show');
                });

                document.addEventListener('click', (e) => {
                    if (!mobileMenuButton.contains(e.target) && !navbarMenu.contains(e.target)) {
                        navbarMenu.classList.remove('show');
                    }
                });
            }
        }

        // 進捗状況を更新
        function updateProgress(step) {
            // すべてのステップをリセット
            for (let i = 1; i <= 6; i++) {
                const stepElement = document.getElementById(`step${i}`);
                stepElement.classList.remove('active', 'completed');
            }

            // 現在のステップまでを更新
            for (let i = 1; i < step; i++) {
                document.getElementById(`step${i}`).classList.add('completed');
            }
            document.getElementById(`step${step}`).classList.add('active');

            // プログレスバーの幅を更新
            const progressWidth = ((step - 1) / 5) * 100;
            document.getElementById('progressFill').style.width = `${progressWidth}%`;

            // 現在のステップ情報を更新
            const data = stepData[step];
            document.getElementById('currentStepInfo').innerHTML = `
                <h2>現在のステータス：${data.title}</h2>
                <p>${data.description}</p>

                <div class="next-action">
                    <strong>次にすべきこと：</strong>
                    <p>${data.nextAction}</p>
                </div>
            `;
        }

        // ステップ詳細を表示
        function showStepDetails(stepNumber) {
            const data = stepData[stepNumber];
            const modal = document.getElementById('detailModal');

            document.getElementById('modalTitle').textContent = data.title;
            document.getElementById('modalSubtitle').textContent = data.subtitle;

            let detailsHTML = `
                <div class="modal-section">
                    <h4>概要</h4>
                    <p>${data.description}</p>
                </div>

                <div class="modal-section">
                    <h4>次にすべきこと</h4>
                    <p>${data.nextAction}</p>
                </div>

                <div class="modal-section">
                    <h4>詳細情報</h4>
            `;

            for (const [label, value] of Object.entries(data.details)) {
                detailsHTML += `
                    <div class="modal-info-row">
                        <span class="modal-info-label">${label}</span>
                        <span class="modal-info-value">${value}</span>
                    </div>
                `;
            }

            detailsHTML += `</div>`;

            // 発送先住所（ステップ1のみ）
            if (stepNumber === 1 && data.shippingAddress) {
                detailsHTML += `
                    <div class="modal-section">
                        <h4>カード発送先</h4>
                        <p>${data.shippingAddress}</p>
                    </div>
                `;
            }

            detailsHTML += `
                <button class="modal-close" onclick="closeModal()">閉じる</button>
            `;

            document.getElementById('modalBody').innerHTML = detailsHTML;
            modal.classList.add('show');
        }

        // モーダルを閉じる
        function closeModal() {
            document.getElementById('detailModal').classList.remove('show');
        }

        // モーダル外クリックで閉じる
        document.getElementById('detailModal').addEventListener('click', (e) => {
            if (e.target.id === 'detailModal') {
                closeModal();
            }
        });
    </script>
</body>
</html>
